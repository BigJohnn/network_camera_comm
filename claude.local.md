## ⭕ 阶段 1 — **分析问题（Problem Analysis）**

### 🎯 必须完成

1. **澄清需求**：用自己的话复述目标；若存在歧义，立即向我提问。
2. **系统搜索**：列出所有相关代码/配置/文档的位置（含跳转链接或文件路径）。
3. **根因定位**：结合日志、栈跟踪与功能路径，说明问题本质。
4. **架构审视**：指出设计缺陷（模块耦合、单一职责违背、接口不清晰等）。
5. **解决方案草案**：提供 1 – 3 个可行方案；若方案与期望目标冲突，则不要列出。
6. **利弊评估**：从性能、可维护性、技术债务、实现成本、未来扩展性角度对比方案。

### 🧭 融入的原则

* **系统性思维**：聚焦整体数据流与控制流，而不仅是局部 bug。
* **第一性原理**：先思考功能本质，再考虑现有实现。
* **DRY**：发现重复逻辑必须显式指出，并建议抽象。
* **长远规划**：评估对技术债务和维护成本的影响。

### 🔒 绝对禁止

* **修改任何代码**。
* **跳过搜索/理解直接给实现**。
* **匆忙定案**：未完成利弊权衡前，不得锁定方案。

---

## 🔧 阶段 2 — **细化方案（Solution Refinement）**

在我选定或确认方案（形如“使用方案 1”或“实现 X 功能”）后启动本阶段。

### 🎯 输出内容

1. **变更清单**：对每个受影响模块列出

   * `新增 / 修改 / 删除` 的文件或类
   * 简洁的职责说明
2. **接口设计**：

   * 精确定义公共方法、参数、返回值、异常。
   * 保证单一职责、最小可行接口（最小输入、最小输出）。
3. **代码规范约束**：

   * 避免冗余 `try‒except`；若必须捕获，**重新抛出**或记录后抛出，便于调试。
   * 使用类型注解、Google/NumPy 风格 docstring。
   * 命名、结构、日志、配置遵循之前的《Python 编码规范》。
4. **测试计划**：列出单元测试 & 集成测试要点、边界场景与期望结果。

### 🔒 绝对禁止

* **直接提交代码**（仅生成设计与计划）。
* **引入未讨论的新技术栈**。

---

## 🚀 阶段 3 — **实现与验证（Implementation & Validation）**

仅在我已确认细化方案后开启。

### 🎯 实施要求

1. **严格按方案编码**：不得擅自扩展或削减功能。
2. **优雅代码**：

   * 函数短小、职责单一。
   * 保持风格一致（PEP 8 + 先前规范）。
   * 必要时用 `assert` 或参数校验替代宽泛 `try‒except`。
3. **测试先行**：同步生成/更新测试用例，确保全部通过。
4. **运行检查**：提供关键运行日志片段或示例输出，验证功能正确。

### 🔒 绝对禁止

* **将代码直接推到远程仓库**，除非我显式要求。
* **忽视失败测试**：任何测试未通过不得交付。

---
